<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Formal Concept Analysis with R - 1&nbsp; Introduction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./contexts.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Formal Concept Analysis with R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./contexts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Formal Contexts and Galois Connections</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lattice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Concept Lattice</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./implications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Implications</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fuzzy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fuzzy Formal Concept Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Some Applications</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The main goal of knowledge retrieval and knowledge discovery systems is to extract hidden patterns, trends, behaviours, or rules to solve large-impact real-world problems. Usually, these problems present heterogeneous data sources and are at the core of more general decision processes.</p>
<p>A fundamental principle is that the extracted knowledge should provide some understanding of the analyzed data. As computational systems get in critical and sensitive areas such as medicine, the justice system or financial markets, the knowledge becomes much more relevant to make predictions or recommendations or to detect common interest groups or leaders. However, in many cases, the inability of humans to understand the extracted patterns seems problematic.</p>
<p>To represent and retrieve knowledge from datasets, it has become more important to use formal methods based on logic tools. The formal representation of knowledge and the use of logic tools are more suitable for providing understandable answers. Therefore, it can help avoid the lack of interpretability and explainability of the results.</p>
<p>In particular, formal concept analysis (FCA) <span class="citation" data-cites="wille1982restructuring Ganter1999">(<a href="references.html#ref-wille1982restructuring" role="doc-biblioref">Wille 1982</a>; <a href="references.html#ref-Ganter1999" role="doc-biblioref">Ganter and Wille 1999</a>)</span> is a well-founded mathematical tool, based on lattice theory and logic, which can retrieve and store the knowledge in the form of concepts (analogous to closed itemsets in transactional databases) and implications (association rules with confidence 1). From this perspective, FCA constitutes a framework that complements and extends the study of exact and approximate association rules.</p>
<p>The origins of FCA were devoted to the study of binary datasets (formal contexts) where variables are called attributes. A relevant extension of FCA uses fuzzy sets (see <span class="citation" data-cites="BeVyAddgI BeVyAddgII">(<a href="references.html#ref-BeVyAddgI" role="doc-biblioref">Belohlávek and Vychodil 2016</a>, <a href="references.html#ref-BeVyAddgII" role="doc-biblioref">2017</a>)</span>) to model real-world problems since datasets may contain imprecise, graded or vague information that is not adequately represented as binary values. The fuzzy extension can also model problems with numerical and categorical attributes since these can be scaled to a truth value describing the degree of fulfilment of the attribute.</p>
<p>Some authors have considered the use of FCA in machine learning. <span class="citation" data-cites="Kuznetsov04">Kuznetsov (<a href="references.html#ref-Kuznetsov04" role="doc-biblioref">2004</a>)</span> relates FCA to some mathematical models of machine learning. <span class="citation" data-cites="Ignatov2015">Ignatov (<a href="references.html#ref-Ignatov2015" role="doc-biblioref">2017</a>)</span> summarizes the main topics in machine learning and data mining where FCA has been applied: frequent itemset mining and association rules to make classification and clustering. A closer approach appears in <span class="citation" data-cites="Trabelsi17">(<a href="references.html#ref-Trabelsi17" role="doc-biblioref">Trabelsi, Meddouri, and Maddouri 2017</a>)</span>, where a method for supervised classification based on FCA is used. The authors extract rules based on concepts generated previously from data. These rules are used to compute the closure of a set of attributes to obtain a classification rule.</p>
<p>From a dataset, FCA can establish maximal clusters, named concepts, between objects and attributes. Each cluster consists of objects having common properties (attributes), which are only fulfilled for these objects. The hierarchy between the concepts and relationships between the attributes (rules or implications) are computed with the same computational cost in FCA.</p>
<p>Among all the techniques used in other areas to extract knowledge, we emphasize using rules for its theoretical and practical interest. The notion of if-then rules, with different names, appears in several areas (databases, machine learning, data mining, formal concept analysis) as a relationship between attributes, called items, properties or atomic symbols regarding the domain. Nowadays, the number of rules extracted even from medium-sized datasets is enormous in all these areas. Therefore, the intelligent manipulation of these rules to reason with them is a hot topic to be explored.</p>
<p>In this direction, <span class="citation" data-cites="Cordero2002">Cordero et al. (<a href="references.html#ref-Cordero2002" role="doc-biblioref">2002</a>)</span> introduced a logic, named simplification logic for functional dependencies (<span class="math inline">\(SL_{FD}\)</span>), firmly based on a simplification rule, which allows us to narrow the functional dependency set by removing redundant attributes. Although the semantic of implications or if-then rules in other areas are different, the logic can be used too.</p>
<p>Using directly <span class="math inline">\(SL_{FD}\)</span>, some automated deduction methods directly based on this inference system have been developed for classical systems and fuzzy systems <span class="citation" data-cites="mora_efficient_2004 Cordero2012 Mora2012 cla2014 Lorenzo2015">(<a href="references.html#ref-mora_efficient_2004" role="doc-biblioref">Mora et al. 2003</a>, <a href="references.html#ref-Mora2012" role="doc-biblioref">2012</a>; <a href="references.html#ref-Cordero2012" role="doc-biblioref">Cordero et al. 2012</a>; <a href="references.html#ref-cla2014" role="doc-biblioref">Rodrı́guez Lorenzo et al. 2014</a>, <a href="references.html#ref-Lorenzo2015" role="doc-biblioref">2015</a>)</span>.</p>
<p>In the fuzzy framework, several approaches to the definition of fuzzy implications (functional dependencies, rules) are proposed in the literature (see <span class="citation" data-cites="JEZKOVA2017">(<a href="references.html#ref-JEZKOVA2017" role="doc-biblioref">Jezková, Cordero, and Enciso 2017</a>)</span> for a survey). Our work considers that the definition of graded implication proposed in <span class="citation" data-cites="BeVyAddgI BeVyAddgII">(<a href="references.html#ref-BeVyAddgI" role="doc-biblioref">Belohlávek and Vychodil 2016</a>, <a href="references.html#ref-BeVyAddgII" role="doc-biblioref">2017</a>)</span> generalizes all the previous definitions. Furthermore, for this general definition of graded implications, an axiomatic system named FASL (fuzzy attribute simplification logic <span class="citation" data-cites="belohlavek2016automated">(<a href="references.html#ref-belohlavek2016automated" role="doc-biblioref">Belohlávek et al. 2016</a>)</span>) was developed, becoming a helpful reasoning tool. Note that FASL is a generalization of <span class="math inline">\(SL_{FD}\)</span> to the fuzzy framework.</p>
<p>The core of our proposal is to provide a user-friendly computational interface to the principal operators and methods of fuzzy FCA, including the mentioned logic tools. This interface is easy to extend to new functionalities and incorporate new methods, such as minimal generators or the computation of different implication bases quickly. The operators and methods implemented are designed to work in the general fuzzy setting, but they are also applicable in the classical binary case.</p>
<p>Thus, the focus of our proposal, the package, is to provide easy access to formal methods to extract all the implicit knowledge in a dataset in the form of concepts and implications, working natively with fuzzy sets and fuzzy implications. Our goal is to provide a unified computational framework for the theoretically-oriented FCA users to develop, test, and compare new methods and knowledge extraction strategies.</p>
<p>Other objectives of this work include presenting an FCA-based tool for knowledge discovery accessible to other scientific communities, allowing for the development of new packages in other fields using FCA techniques, especially in the construction of recommendation systems.</p>
<p>The work is organized as follows: Section&nbsp; begins with a brief look of FCA and Simplification Logic. Section&nbsp; presents other software libraries that implement FCA or related paradigms’ core notions. In Section&nbsp;, an explanation of the data structures, classes and constructor methods is covered. Section&nbsp; shows how to use the package, describing the implemented FCA methods and the use of the simplification logic. In Section&nbsp;, a real application of the package in developing a recommender system is illustrated. Finally, some conclusions and future works are presented in Section&nbsp;.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-belohlavek2016automated" class="csl-entry" role="listitem">
Belohlávek, Radim, Pablo Cordero, Manuel Enciso, Angel Mora, and Vilém Vychodil. 2016. <span>“Automated Prover for Attribute Dependencies in Data with Grades.”</span> <em>International Journal of Approximate Reasoning</em> 70: 51–67. <a href="https://doi.org/10.1016/j.ijar.2015.12.007">https://doi.org/10.1016/j.ijar.2015.12.007</a>.
</div>
<div id="ref-BeVyAddgI" class="csl-entry" role="listitem">
Belohlávek, Radim, and Vilém Vychodil. 2016. <span>“Attribute Dependencies for Data with Grades <span>I</span>.”</span> <em>International Journal of General Systems</em> 45 (7-8): 864–88. <a href="https://doi.org/10.1080/03081079.2016.1205711">https://doi.org/10.1080/03081079.2016.1205711</a>.
</div>
<div id="ref-BeVyAddgII" class="csl-entry" role="listitem">
———. 2017. <span>“Attribute Dependencies for Data with Grades <span>II</span>.”</span> <em>International Journal of General Systems</em> 46 (1): 66–92. <a href="https://doi.org/10.1080/03081079.2016.1205712">https://doi.org/10.1080/03081079.2016.1205712</a>.
</div>
<div id="ref-Cordero2012" class="csl-entry" role="listitem">
Cordero, Pablo, Manuel Enciso, Angel Mora, and Manuel Ojeda-Aciego. 2012. <span>“Computing Minimal Generators from Implications: A Logic-Guided Approach.”</span> In <em>CLA 2012</em>, 972:187–98. <span>CEUR</span> w.proc. CEUR-WS.org. <a href="http://ceur-ws.org/Vol-972/paper16.pdf">http://ceur-ws.org/Vol-972/paper16.pdf</a>.
</div>
<div id="ref-Cordero2002" class="csl-entry" role="listitem">
Cordero, Pablo, Manuel Enciso, Angel Mora, and Inman P. de Guzmán. 2002. <span>“<span>SL<span class="math inline">\({}_{\mbox{FD}}\)</span></span> Logic: Elimination of Data Redundancy in Knowledge Representation.”</span> In <em><span>IBERAMIA</span></em>, 2527:141–50. LNCS. Springer. <a href="https://doi.org/10.1007/3-540-36131-6_15">https://doi.org/10.1007/3-540-36131-6_15</a>.
</div>
<div id="ref-Ganter1999" class="csl-entry" role="listitem">
Ganter, Bernhard, and Rudolf Wille. 1999. <em>Formal Concept Analysis - Mathematical Foundations</em>. Springer. <a href="https://doi.org/10.1007/978-3-642-59830-2">https://doi.org/10.1007/978-3-642-59830-2</a>.
</div>
<div id="ref-Ignatov2015" class="csl-entry" role="listitem">
Ignatov, Dmitry I. 2017. <span>“Introduction to Formal Concept Analysis and Its Applications in Information Retrieval and Related Fields.”</span> <em>CoRR</em> abs/1703.02819.
</div>
<div id="ref-JEZKOVA2017" class="csl-entry" role="listitem">
Jezková, L., Pablo Cordero, and Manuel Enciso. 2017. <span>“Fuzzy Functional Dependencies: <span>A</span> Comparative Survey.”</span> <em>Fuzzy Sets and Systems</em> 317: 88–120. <a href="https://doi.org/10.1016/j.fss.2016.06.019">https://doi.org/10.1016/j.fss.2016.06.019</a>.
</div>
<div id="ref-Kuznetsov04" class="csl-entry" role="listitem">
Kuznetsov, Sergei O. 2004. <span>“Machine Learning and Formal Concept Analysis.”</span> In <em><span>ICFCA</span> 2004</em>, 2961:287–312. LNCS. Springer. <a href="https://doi.org/10.1007/978-3-540-24651-0_25">https://doi.org/10.1007/978-3-540-24651-0_25</a>.
</div>
<div id="ref-Mora2012" class="csl-entry" role="listitem">
Mora, Angel, Pablo Cordero, Manuel Enciso, Inmaculada Fortes, and Gabriel Aguilera. 2012. <span>“Closure via Functional Dependence Simplification.”</span> <em>International Journal of Computer Mathematics</em> 89 (4): 510–26. <a href="https://doi.org/10.1080/00207160.2011.644275">https://doi.org/10.1080/00207160.2011.644275</a>.
</div>
<div id="ref-mora_efficient_2004" class="csl-entry" role="listitem">
Mora, Angel, Manuel Enciso, Pablo Cordero, and Inmaculada Perez de Guzmán. 2003. <span>“An Efficient Preprocessing Transformation for Functional Dependencies Sets Based on the Substitution Paradigm.”</span> In <em><span>CAEPIA</span> 2003</em>, 3040:136–46. LNCS. Springer. <a href="https://doi.org/10.1007/978-3-540-25945-9_14">https://doi.org/10.1007/978-3-540-25945-9_14</a>.
</div>
<div id="ref-Lorenzo2015" class="csl-entry" role="listitem">
Rodrı́guez Lorenzo, Estrella, Kira V. Adaricheva, Pablo Cordero, Manuel Enciso, and Angel Mora. 2015. <span>“From an Implicational System to Its Corresponding d-Basis.”</span> In <em>CLA 2015</em>, 1466:217–28. <span>CEUR</span> w.proc. CEUR-WS.org. <a href="http://ceur-ws.org/Vol-1466/paper18.pdf">http://ceur-ws.org/Vol-1466/paper18.pdf</a>.
</div>
<div id="ref-cla2014" class="csl-entry" role="listitem">
Rodrı́guez Lorenzo, Estrella, Karell Bertet, Pablo Cordero, Manuel Enciso, and Angel Mora. 2014. <span>“The Direct-Optimal Basis via Reductions.”</span> In <em>CLA 2014</em>, 1252:145–56. <span>CEUR</span> w.proc. CEUR-WS.org. <a href="http://ceur-ws.org/Vol-1252/cla2014_submission_18.pdf">http://ceur-ws.org/Vol-1252/cla2014_submission_18.pdf</a>.
</div>
<div id="ref-Trabelsi17" class="csl-entry" role="listitem">
Trabelsi, Marwa, Nida Meddouri, and Mondher Maddouri. 2017. <span>“A New Feature Selection Method for Nominal Classifier Based on Formal Concept Analysis.”</span> In <em>KES 2017</em>, 112:186–94. Procedia Computer Science. Elsevier. <a href="https://doi.org/10.1016/j.procs.2017.08.227">https://doi.org/10.1016/j.procs.2017.08.227</a>.
</div>
<div id="ref-wille1982restructuring" class="csl-entry" role="listitem">
Wille, Rudolf. 1982. <span>“Restructuring Lattice Theory: An Approach Based on Hierarchies of Concepts.”</span> In <em>Ordered Sets</em>, 445–70. Springer.
</div>
</div>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./contexts.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Formal Contexts and Galois Connections</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>